# NGL Data Proxy Component: Development and Publication Workflow

This document outlines the structure, tools, and process for developing, testing, and publishing the NGL data proxy component.

---

### 1. Final Project Structure

The project separates library source code (`src`) from the testing environment (`example`). A root `index.html` serves as the test-bed, driven by Vite.

```
ngl_data_proxy/
├── dist/                  # (Generated by build) Final library output
├── lib/
│   └── ngl.js             # The local NGL library file
├── src/
│   └── index.ts           # Library source code entry point
├── example/
│   └── main.ts            # Script for the test page (imports from src/ and lib/)
├── .gitignore
├── index.html             # The HTML page for browser-based testing
├── package.json
└── tsconfig.json
└── vite.config.js         # Vite's configuration file
```

### 2. Core Tools

*   **Vite**: Serves as both the development server for live testing and the build tool for bundling the final library.
*   **TypeScript (`tsc`)**: For type-checking and generating type declaration files (`.d.ts`).
*   **npm**: For dependency management and script execution.
*   **Git**: For version control.

### 3. Development and Publication Workflow

#### Phase 1: Project Initialization

1.  **Initialize `package.json`**: Use `npm init -y`.
2.  **Install Dev Dependencies**: Install `vite`, `typescript`, `@types/node`, and `@types/ngl`.
3.  **Create Directory Structure**: Create `src`, `lib`, and `example` directories.
4.  **Copy `ngl.js`**: Copy the provided `context/ngl.js` to the `lib` directory.
5.  **Create `vite.config.js`**: Configure Vite for library mode.
6.  **Create `tsconfig.json`**: Configure TypeScript for a Vite project.
7.  **Create `index.html`**: Create the host page for testing.
8.  **Create `example/main.ts`**: Create the entry script for the test page.
9.  **Configure `package.json`**: Add `dev` and `build` scripts, and fields for publishing (`main`, `types`, `files`).
10. **Create `.gitignore`**: Add standard ignore patterns for a Node.js project.

#### Phase 2: Component Development & Testing

1.  **Start Dev Server**: Run `npm run dev`.
2.  **Open Browser**: Open the local URL provided by Vite to see the test page.
3.  **Write Library Code**: Develop the component in the `src` directory.
4.  **Write Test-Bed Code**: In `example/main.ts`, import the component and use it with a real NGL player instance.
5.  **Live Verification**: Observe changes in the browser in real-time thanks to Vite's Hot Module Replacement (HMR). Manually test the component's functionality.

#### Phase 3: Build and Publish

1.  **Execute Build**: Run `npm run build`. This command will use `tsc` to generate type definitions and `vite build` to create the distributable JavaScript bundles in the `dist` directory.
2.  **Verify Output**: Check the contents of the `dist` folder.
3.  **Publish to NPM**: Run `npm login`, `npm version`, and `npm publish`.

---

## 执行历史 (Execution History)

*   **2025-08-22**:
    *   
